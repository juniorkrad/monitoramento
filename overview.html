<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visão Geral</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">    
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <div id="toast-container"></div>

    <div class="page-container">
        <header class="header">
            <div class="logo-title-group">
                <img src="banner2.png" alt="Logo da Empresa">
                <h1>Visão Geral</h1>
            </div>
            <nav class="header-nav">
                <span id="update-timestamp">Buscando dados...</span>
                <a href="index.html" class="nav-button">Home</a>
            </nav>
        </header>

        <main class="main-content">
            <div id="overview-grid" class="grid-container overview-grid">
                </div>
        </main>
    </div>

    <footer class="footer">
        <p>© 2025 Painel de Monitoramento | Versão 1.0</p>
    </footer>

    <script>
        const oltsConfig = [
            { id: 'HEL-1', sheetTab: 'HEL1', type: 'nokia' },
            { id: 'HEL-2', sheetTab: 'HEL2', type: 'nokia' },
            { id: 'PQA-1', sheetTab: 'PQA1', type: 'nokia' },
            { id: 'PSV-1', sheetTab: 'PSV1', type: 'nokia' },
            { id: 'MGP',   sheetTab: 'MGP',  type: 'nokia' },
            { id: 'LTXV-1', sheetTab: 'LTXV1', type: 'furukawa' },
            { id: 'LTXV-2', sheetTab: 'LTXV2', type: 'furukawa' },
            { id: 'PQA-2',  sheetTab: 'PQA2',  type: 'furukawa' },
            { id: 'PQA-3',  sheetTab: 'PQA3',  type: 'furukawa' },
            { id: 'SB-1',   sheetTab: 'SB1',   type: 'furukawa' },
            { id: 'SB-2',   sheetTab: 'SB2',   type: 'furukawa' },
            { id: 'SB-3',   sheetTab: 'SB3',   type: 'furukawa' },
            { id: 'PSV-7',  sheetTab: 'PSV7',  type: 'furukawa' },
            { id: 'SBO-1',  sheetTab: 'SBO1',  type: 'furukawa' },
            { id: 'SBO-2',  sheetTab: 'SBO2',  type: 'furukawa' },
            { id: 'SBO-3',  sheetTab: 'SBO3',  type: 'furukawa' },
            { id: 'SBO-4',  sheetTab: 'SBO4',  type: 'furukawa' },
        ];

        const API_KEY = 'AIzaSyA88uPhiRhU3JZwKYjA5B1rX7ndXpfka0I';
        const SHEET_ID = '1BDx0zd0UGzOr2qqg1nftfe5WLUMh6MkcFO5psAG5GtU';
        const REFRESH_INTERVAL_SECONDS = 300;
        
        let currentProblems = new Set();
        function showToast(message, type = '') { /* ... (código do toast) ... */ }

        function createCardPlaceholders() {
            const grid = document.getElementById('overview-grid');
            grid.innerHTML = '';
            oltsConfig.forEach(olt => {
                const pageUrl = olt.id.toLowerCase().replace('-', '') + '.html';
                grid.innerHTML += `
                    <div class="overview-card" id="card-${olt.id}">
                        <div class="card-header">
                            <h3>${olt.id}</h3>
                            <a href="${pageUrl}" class="card-header-button">Detalhes →</a>
                        </div>
                        <div class="card-body">
                             <div class="card-stats">
                                <p>Carregando...</p>
                            </div>
                        </div>
                    </div>
                `;
            });
        }
        
        // ... (o resto do seu script JavaScript continua o mesmo) ...
        
        async function runOverview() {
            const now = new Date();
            const timestampText = `Atualizado em: ${now.toLocaleDateString('pt-BR')} às ${now.toLocaleTimeString('pt-BR')}`;
            document.getElementById('update-timestamp').textContent = timestampText;
            createCardPlaceholders();
            const promises = oltsConfig.map(olt => fetchOltData(olt));
            await Promise.all(promises);
        }

        document.addEventListener('DOMContentLoaded', () => {
            runOverview();
            setInterval(runOverview, REFRESH_INTERVAL_SECONDS * 1000);
        });

        async function fetchOltData(olt) { /* ... (função sem alterações) ... */ }
        function updateCardUI(oltId, data) { /* ... (função sem alterações) ... */ }

    </script>
</body>
</html>